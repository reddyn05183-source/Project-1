<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Admin Delete Product</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }

    .product-box {
      border: 1px solid #3498db;
      padding: 20px;
      width: 400px;
      margin: 50px auto;
      border-radius: 8px;
      text-align: center;
    }

    table {
      width: 100%;
      margin-bottom: 20px;
      border-collapse: collapse;
    }

    th,
    td {
      border: 1px solid #333;
      padding: 8px;
    }

    .alert-box {
      border: 1px solid #333;
      border-radius: 8px;
      padding: 15px;
      background: #f8f8f8;
      margin: 20px auto;
    }

    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      margin: 10px;
      cursor: pointer;
    }

    .btn-yes {
      background: #e74c3c;
      color: #fff;
    }

    .btn-no {
      background: #95a5a6;
      color: #fff;
    }

    .btn-yes:hover {
      background: #c0392b;
    }

    .btn-no:hover {
      background: #7f8c8d;
    }

    .top-links {
      display: flex;
      justify-content: space-between;
      margin: 10px 50px;
    }

    a {
      text-decoration: none;
      color: #3498db;
    }
  </style>
</head>

<body>
  <div class="top-links">
    <a href="./Adminhomepage.html">Admin Homepage</a>
    <a href="/logout">Logout</a>
  </div>

  <h2 style="text-align:center;">Admin Delete Product</h2>

  <div class="product-box">
    <table>
      <tr>
        <th>Code</th>
        <th>Name</th>
        <th>Category</th>
        <th>Amount</th>
      </tr>
      <tr>
        <td id="code"></td>
        <td id="name"></td>
        <td id="category"></td>
        <td id="amount"></td>
      </tr>
    </table>

    <div class="alert-box">
      <p><strong>Alert:</strong> Are you sure you want to delete this product?</p>
      <button class="btn btn-no" onclick="cancelDelete()">No</button>
      <button class="btn btn-yes" onclick="confirmDelete()">Yes</button>
    </div>
  </div>

  <script>
    // Get product code from query string: /delete?code=123
    const urlParams = new URLSearchParams(window.location.search);
    const productCode = urlParams.get("code");

    async function loadProduct() {
      const res = await fetch(`/api/products/${productCode}`);
      if (res.ok) {
        const p = await res.json();
        document.getElementById("code").innerText = p.code;
        document.getElementById("name").innerText = p.name;
        document.getElementById("category").innerText = p.category;
        document.getElementById("amount").innerText = "Rs." + p.amount;
      } else {
        alert("Product not found");
        window.location.href = "/";
      }
    }

    async function confirmDelete() {
      const res = await fetch(`/api/products/${productCode}`, { method: "DELETE" });
      if (res.ok) {
        alert("Product deleted successfully!");
        window.location.href = "/";
      } else {
        alert("Error deleting product");
      }
    }

    function cancelDelete() {
      window.location.href = "/";
    }

    loadProduct();
  </script>
</body>

</html>